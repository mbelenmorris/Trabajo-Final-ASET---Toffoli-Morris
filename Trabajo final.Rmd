---
title: "La precariedad laboral en la EPH"
subtitle: "Trabajo final. Curso ASET 2024"
author: "Magdalena Tóffoli y Belén Morris"
date: "2025-03-04"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    theme: spacelab
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE, #con esto no se muestra código en el informe
	message = FALSE, #con esto no se muestran mjes 
	warning = FALSE #ni advertencias
)
```

```{r librerias, include=FALSE}
library(eph)
library(tidyverse)
library(dplyr)
library(janitor)
library(srvyr)
library(haven)
library(kableExtra)
library(ggplot2)
library(scales)
library(ggthemes)
library(RColorBrewer)
library(knitr)
library(webshot)
library(rmarkdown)
```

```{r base, echo=FALSE}

EPH2019_2023CAES <- readRDS("EPH2019_2023CAES.rds")
```

## Introducción

En este trabajo nos proponemos analizar la dinámica de la precariedad laboral a partir de la EPH individual. Tomamos como referencia el tercer trimestre del período 2019-2023 para el total de aglomerados urbanos. Entendemos que este fenómeno es multidimensional y está atravesado por las heterogeneidades del mundo del trabajo.

En función de esta premisa, analizaremos cómo está compuesta la población en la sección [Descripción de la población de la muestra]. Nos referiremos en particular a la edad, la condición sexo genérica, el origen étnico nacional y el nivel educativo. En segundo lugar, contemplamos una serie de dimensiones que contribuyen a configurar ámbitos laborales diferenciados, tales como la categoría ocupacional, el sector de actividad, el tipo de empleador (público o privado), el tamaño del establecimiento donde se desempeñan los trabajadores, entre otras. Consideramos que estos aspectos inciden diferencialmente en la precariedad laboral.

Luego, en [La precariedad como fenómeno multidimensional] presentaremos un índice de precariedad de laboral que se compone de cuatro dimensiones constitutivas: las condiciones laborales, el grado de estabilidad laboral, los ingresos y el nivel de intensidad laboral. Finalmente, en la sección [Análisis de la precariedad] presentamos un análisis que entrecruza el índice de precariedad laboral con las variables presentadas al inicio.

## Descripción de la población de la muestra 

A continuación, analizamos cómo se compone la población de la muestra, tomando como referencia aquellas variables que consideramos especialmente relevantes para en el análisis de la precariedad.

## Variables demográficas {.tabset}

### Sexo
Aproximadamente el 51% son mujeres y el 48% son varones, distribución que, con pequeñas variaciones (51,3 al 51,7 y 48,3 al 48,7), se mantiene a lo largo del período analizado.

```{r muestra sexo, echo=FALSE}
graf_sexoyaño <- ggplot(EPH2019_2023CAES, aes(x = ANO4, y = PONDERA, fill = SEXO)) + 
  geom_bar(stat = "identity", position = "fill") + 
  scale_fill_brewer(palette="Set3")+
  labs(title = "Sexo de la población por año",
       subtitle = "Total de 31 aglomerados. Terceros trimestres de 2019-2023",
       x = "Año",
       y = "Población") +
  theme_calc() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  guides(size = "none")

print(graf_sexoyaño)
```


### Grupos etarios

Identificamos tres grupos etarios: de 16 a 30 años, de 31 a 50 y de 51 o más. El primer grupo ronda el 30% del total de la población de la muestra; el segundo y el tercero, entre el 33 y 36%

```{r muestra grupos etarios, echo=FALSE}
gruposetarios_año_pond <- EPH2019_2023CAES %>% filter (!is.na(grupos_etarios)) %>% 
  group_by(ANO4, grupos_etarios) %>% 
  summarize(casos = sum(PONDERA)) %>% 
  mutate(Porcentaje = round((casos / sum(casos)) * 100, 1))

gruposetarios_año_pond <- gruposetarios_año_pond %>%
  mutate(
    ANO4 = as_factor(ANO4),  # Convertir año a factor
   casos = as.numeric(casos),  # Asegurar que casos sea numérico
    grupos_etarios = as_factor(grupos_etarios)  # Convertir la variable de grupos etarios a factor
  ) %>%
  group_by(ANO4) %>%
  mutate(porcentaje = casos / sum(casos)) %>%  # Calcular proporciones dentro de cada año
  ungroup()

graf_gruposetarios <- ggplot(gruposetarios_año_pond, aes(x = ANO4, y = porcentaje, fill = grupos_etarios)) + 
  geom_bar(stat = "identity", ) +  
  scale_fill_brewer(palette = "Set3") +  # Paleta de colores
  labs(title = "Distribución de grupos etarios por año",
       subtitle = "Total de 31 aglomerados. Terceros trimestres de 2019-2023",
       x = "Año",
       y = "Población") +
  theme_calc() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +  
  guides(size = "none")+
  geom_text(aes(label = scales::percent(porcentaje, accuracy = 1)),
            position = position_stack(vjust = 0.5),  # Centrar las etiquetas en las pilas
            color = "black", fontface = "bold", size = 3)

print(graf_gruposetarios)
```
### Lugar de nacimiento

Entre un 82 y 85 % de la población trabaja en la misma provincia en la que nació. Los migrantes internos representan entre un 10 y 12%, mientras que la población migrante tiene una presencia todavía menor en los datos relevados: aproximadamente entre el 3 y el 5%, siendo en su mayoría proveniente de países limítrofes


```{r muestra lugar nacimiento}
lugarnacimiento_año_pond <- EPH2019_2023CAES %>% filter(!is.na(lugar_nacimiento)) %>% 
  group_by(ANO4, lugar_nacimiento) %>% 
  summarize(casos = sum(PONDERA)) %>% 
  mutate(Porcentaje = round((casos / sum(casos)) * 100, 1))

lugarnacimiento_año_pond <- lugarnacimiento_año_pond %>%
  mutate(
    ANO4 = as_factor(ANO4),  # Convertir año a factor
    casos = as.numeric(casos),  # Asegurar que casos sea numérico
    lugar_nacimiento = as_factor(lugar_nacimiento)  # Convertir la variable lugar_nacimiento a factor
  ) %>%
  group_by(ANO4) %>%
  mutate(porcentaje = casos / sum(casos)) %>%  # Calcular proporciones dentro de cada año
  ungroup()

# Crear gráfico de barras apiladas
graf_lugar_nacimiento <- ggplot(lugarnacimiento_año_pond, aes(x = ANO4, y = porcentaje, fill = lugar_nacimiento)) + 
  geom_bar(stat = "identity") +
  scale_fill_brewer(palette = "Set3") +  # Paleta de colores
  labs(title = "Lugar de nacimiento por año",
       subtitle = "Total de 31 aglomerados. Terceros trimestres de 2019-2023",
       x = "Año",
       y = "Población") +
  theme_calc() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +  # Mostrar en porcentaje
  guides(size = "none")+
  geom_text(aes(label = scales::percent(porcentaje, accuracy = 1)),
            position = position_stack(vjust = 0.5),  
            color = "#313332", fontface = "bold", size = 2.5)
print(graf_lugar_nacimiento)
```

### Nivel educativo alcanzado 

En relación con el nivel educativo alcanzado, podemos señalar que hacia el final de la serie se incrementa en dos puntos porcentuales la población que ha culminado el nivel secundario. Entre 2021 y 2023, a su vez, aumenta en un punto la población universitaria.

```{r muestra nivel educativo, echo=FALSE}
nivel_educativo_año_pond <- EPH2019_2023CAES %>% filter(!is.na(nivel_educativo_completo)) %>% 
  group_by(ANO4, nivel_educativo_completo) %>% 
  summarize(casos = sum(PONDERA)) %>% 
  mutate(Porcentaje = round((casos / sum(casos)) * 100, 1))

# Convertir variables adecuadas y calcular proporciones dentro de cada año
nivel_educativo_año_pond <- nivel_educativo_año_pond %>%
  mutate(
    ANO4 = as_factor(ANO4),  # Convertir año a factor
    casos = as.numeric(casos),  # Asegurar que casos sea numérico
    nivel_educativo_completo = as_factor(nivel_educativo_completo)  # Convertir la variable lugar_nacimiento a factor
  ) %>%
  group_by(ANO4) %>%
  mutate(porcentaje = casos / sum(casos)) %>%  # Calcular proporciones dentro de cada año
  ungroup()

# Crear gráfico de barras apiladas
graf_nivel_educativo <- ggplot(nivel_educativo_año_pond, aes(x = ANO4, y = porcentaje, fill = nivel_educativo_completo)) + 
  geom_bar(stat = "identity") +
  scale_fill_brewer(palette = "Set3") +  # Paleta de colores
  labs(title = "Nivel educativo completo por año",
       subtitle = "Total de 31 aglomerados. Terceros trimestres de 2019-2023",
       x = "Año",
       y = "Población") +
  theme_calc() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +  # Mostrar en porcentaje
  guides(size = "none")+
  geom_text(aes(label = scales::percent(porcentaje, accuracy = 1)),
            position = position_stack(vjust = 0.5),  
            color = "#313332", fontface = "bold", size = 2.5)
print(graf_nivel_educativo)
```

## Variables laborales {.tabset}

### Condición de actividad

El porcentaje de población ocupada se mantiene constante entre los años 2019 y 2021. Hacia 2023 la cantidad de población aumenta dos puntos porcentuales. La contraparte es la reducción de la población inactiva y desocupada.

```{r}
cond_actividad_pond <- EPH2019_2023CAES %>% 
  group_by(ANO4, ESTADO) %>% 
  summarize(casos = sum(PONDERA)) %>% 
  mutate(Porcentaje = round((casos / sum(casos)), 2),
        Condición_actividad = case_when(
    ESTADO== 1 ~ "Ocupado/a",
    ESTADO == 2 ~ "Desocupado/a",
    ESTADO == 3 ~ "Inactivo/a",
    ESTADO == 4 ~ "Menor de 10 anos",
    TRUE ~ "Otro"  # Para manejar cualquier otro valor posible
  )) 
cond_actividad_pond_acotada = cond_actividad_pond %>% 
  select(-casos, -ESTADO) 

graf_cond_actividad <- ggplot(cond_actividad_pond_acotada, aes(x = ANO4, y = Porcentaje, fill = Condición_actividad)) + 
  geom_bar(stat = "identity", position = "fill") +
  coord_flip() +
  scale_fill_brewer(palette = "Set3") +  # Paleta de colores
  labs(title = "Codición de actividad por año",
       subtitle = "Total de 31 aglomerados. Terceros trimestres de 2019-2023",
       x = "Año",
       y = "Población") +
  theme_calc() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +  # Mostrar en porcentaje
  guides(size = "none")+
  geom_text(aes(label = scales::percent(Porcentaje, accuracy = 0.1)),
            position = position_stack(vjust = 0.5),  
            color = "#313332", fontface = "bold", size = 2.5)
print(graf_cond_actividad)
```

### Categoría ocupacional 


```{r echo=FALSE}

install.packages("ggrepel")
library(ggrepel)
table(EPH2019_2023CAES$CAT_OCUP)
categ_ocupacional_pond <- EPH2019_2023CAES %>% 
  group_by(ANO4, CAT_OCUP) %>% 
  summarize(casos = sum(PONDERA)) %>% 
  mutate(Porcentaje = round((casos / sum(casos)),2),
        Categoría_ocupacional = case_when(
    CAT_OCUP== 1 ~ "Patrón",
    CAT_OCUP == 2 ~ "Cuenta propia",
    CAT_OCUP == 3 ~ "Obrero o empleado",
    CAT_OCUP == 4 ~ "Trabajador familiar sin remuneración",
    TRUE ~ NA  
  ))

categ_ocupacional_pond_filtrada <- categ_ocupacional_pond %>%
  filter(!is.na(Categoría_ocupacional))

graf_cat_ocup <- ggplot(categ_ocupacional_pond_filtrada, aes(x = ANO4, y = Porcentaje, fill = Categoría_ocupacional)) + 
  geom_bar(stat = "identity", position = "fill") +
  scale_fill_brewer(palette = "Set3") +  
  labs(title = "Categoría ocupacional por año",
       subtitle = "Total de ocupados de 31 aglomerados. Terceros trimestres de 2019-2023",
       x = "Año",
       y = "Población") +
  theme_calc() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.01)) +  # Mostrar en porcentaje
  guides(size = "none")
   
print(graf_cat_ocup)
```




```{r}
Estado1_sexo <-  EPH2019_2023CAES %>%  
  filter(!is.na(ESTADO) & ESTADO == 1) %>%  
  group_by(ANO4, SEXO) %>% 
  summarize(casos = sum(PONDERA), .groups = "drop") %>%  
  group_by(ANO4) %>%  
  mutate(Porcentaje = round((casos / sum(casos)) * 100, 1))

Estado1_sexo %>%
  kable(caption = "Población ocupada según sexo (2019-2023)", 
        col.names = c("Año", "Sexo", "Casos", "Porcentaje")) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = T, 
                position = "center") %>% 
  row_spec(0, bold = TRUE, background = "#4dd686", color = "white") %>%
  row_spec(seq(1, nrow(Estado1_sexo), 2), background = "#F5F5F5") %>% 
  collapse_rows(columns = 1, valign = "middle")
```

Durante el período 2019-2023, el nivel de ocupación en la población femenina presenta un rezago respecto de la población masculina de entre 11 y 16 puntos porcentuales. Es interesante observar que en los años inmediatamente posteriores a la pandemia, 2021 y 2022, esta brecha se incrementa significativamente en relación a los años precedentes para luego reubicarse, hacia el final del período, en valores similares a 2019.

```{r echo=FALSE}

Estado1_sexo <-  EPH2019_2023CAES %>%  
  filter(!is.na(ESTADO) & ESTADO == 1) %>%  
  group_by(ANO4, SEXO) %>% 
  summarize(casos = sum(PONDERA), .groups = "drop") %>%  
  group_by(ANO4) %>%  
  mutate(Porcentaje = round((casos / sum(casos)) * 100, 1))

Estado1_sexo %>%
  kable(caption = "Población ocupada según sexo (2019-2023)", 
        col.names = c("Año", "Sexo", "Casos", "Porcentaje")) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = T, 
                position = "center") %>% 
  row_spec(0, bold = TRUE, background = "#4dd686", color = "white") %>%
  row_spec(seq(1, nrow(Estado1_sexo), 2), background = "#F5F5F5") %>% 
  collapse_rows(columns = 1, valign = "middle")
```

Este fenómeno puede estar relacionado a la sobrecarga de trabajo de cuidado doméstico y familiar que recayó sobre las mujeres producto de las restricciones a la circulación.

## La precariedad como fenómeno multidimensional

### Análisis de la precariedad

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
